ifelse(grepl("black", race), "Black or African American",
ifelse(grepl("american_indian", race),  "American Indian or Alaska Native",
ifelse(grepl("native_hawaiian", race),  "Native Hawaiian or Other Pacific Islander",
ifelse(grepl("two_or", race), "Two or More Races",
ifelse(grepl("asian", race), "Asian",
ifelse(grepl("some", race), "Race ethnicity unknown",
race))))))))) %>%
filter(!grepl("two_races", race))
View(demo)
# demo_hispanic = map_dfr(unique(demo_csvs$files), ~read.csv(.x, skip=1) %>% mutate_all(as.character) %>%
#                       mutate(year = str_extract(.x, "([0-9]{4}(?=\\.{1}))"))) %>%
#   select(year, contains("HISPANIC"), -contains("Margin"), -contains("Percent")) %>%
#   clean_names(.) %>%
#   select(year, ends_with("hispanic_or_latino_of_any_race")) %>%
#   mutate(value = coalesce(estimate_hispanic_or_latino_and_race_hispanic_or_latino_of_any_race,
#                              estimate_hispanic_or_latino_and_race_total_population_hispanic_or_latino_of_any_race)) %>%
#   mutate(race_extract = "Hispanic") %>%
#   select(year, race_extract, value)
demo = map_dfr(unique(demo_csvs$files), ~read.csv(.x, skip=1) %>% mutate_all(as.character) %>%
mutate(year = str_extract(.x, "([0-9]{4}(?=\\.{1}))"))) %>%
select(year, ends_with("any.race."), contains("NOT.HISPANIC"), -contains("Margin"), -contains("Percent")) %>%
clean_names(.) %>%
select(-ends_with("hispanic_or_latino")) %>%
pivot_longer(!year, names_to = "race", values_to = "value") %>%
mutate(race_extract = ifelse(grepl("hispanic_or_latino_of_any_race", race), "Hispanic",
ifelse(grepl("white", race), "White",
ifelse(grepl("black", race), "Black or African American",
ifelse(grepl("american_indian", race),  "American Indian or Alaska Native",
ifelse(grepl("native_hawaiian", race),  "Native Hawaiian or Other Pacific Islander",
ifelse(grepl("two_or", race), "Two or More Races",
ifelse(grepl("asian", race), "Asian",
ifelse(grepl("some", race), "Race ethnicity unknown",
race))))))))) %>%
filter(!grepl("two_races", race)) %>%
group_by(year, race_extract) %>%
summarize(value = sum(as.numeric(value), na.rm = TRUE)) %>%
group_by(year) %>%
mutate(total = sum(value)) %>%
select(year, race_extract, value, total)
demo = map_dfr(unique(demo_csvs$files), ~read.csv(.x, skip=1) %>% mutate_all(as.character) %>%
mutate(year = str_extract(.x, "([0-9]{4}(?=\\.{1}))"))) %>%
select(year, ends_with("any.race."), contains("NOT.HISPANIC"), -contains("Margin"), -contains("Percent")) %>%
clean_names(.) %>%
select(-ends_with("hispanic_or_latino")) %>%
pivot_longer(!year, names_to = "race", values_to = "value") %>%
mutate(race_extract = ifelse(grepl("hispanic_or_latino_of_any_race", race), "Hispanic",
ifelse(grepl("white", race), "White",
ifelse(grepl("black", race), "Black or African American",
ifelse(grepl("american_indian", race),  "American Indian or Alaska Native",
ifelse(grepl("native_hawaiian", race),  "Native Hawaiian or Other Pacific Islander",
ifelse(grepl("two_or", race), "Two or More Races",
ifelse(grepl("asian", race), "Asian",
ifelse(grepl("some", race), "Race ethnicity unknown",
race))))))))) %>%
filter(!grepl("two_races", race)) %>%
group_by(year, race_extract) %>%
summarize(value = sum(as.numeric(value), na.rm = TRUE)) %>%
group_by(year) %>%
mutate(total = sum(value)) %>%
ungroup() %>%
mutate(percent = value/total) %>%
select(year, race = race_extract, value, total, percent)
library(tidyverse)
library(janitor)
# Download ACS data for race from link below:
# https://data.census.gov/cedsci/table?q=race%2Fethnicity%20oregon&tid=ACSDT1Y2018.B02001
# https://data.census.gov/cedsci/table?q=race&tid=ACSDP1Y2019.DP05
setwd("C:/Users/Colton/Desktop/WOUApp")
demo_csvs = data.frame(files = list.files("./Demographics/productDownload_2021-06-01T143832", full.names =  TRUE)) %>%
mutate(data = grepl("data_with_overlays", files)) %>%
filter(data == TRUE)
demo = map_dfr(unique(demo_csvs$files), ~read.csv(.x, skip=1) %>% mutate_all(as.character) %>%
mutate(year = str_extract(.x, "([0-9]{4}(?=\\.{1}))"))) %>%
select(year, ends_with("any.race."), contains("NOT.HISPANIC"), -contains("Margin"), -contains("Percent")) %>%
clean_names(.) %>%
select(-ends_with("hispanic_or_latino")) %>%
pivot_longer(!year, names_to = "race", values_to = "value") %>%
mutate(race_extract = ifelse(grepl("hispanic_or_latino_of_any_race", race), "Hispanic",
ifelse(grepl("white", race), "White",
ifelse(grepl("black", race), "Black or African American",
ifelse(grepl("american_indian", race),  "American Indian or Alaska Native",
ifelse(grepl("native_hawaiian", race),  "Native Hawaiian or Other Pacific Islander",
ifelse(grepl("two_or", race), "Two or More Races",
ifelse(grepl("asian", race), "Asian",
ifelse(grepl("some", race), "Race ethnicity unknown",
race))))))))) %>%
filter(!grepl("two_races", race)) %>%
group_by(year, race_extract) %>%
summarize(value = sum(as.numeric(value), na.rm = TRUE)) %>%
group_by(year) %>%
mutate(total = sum(value)) %>%
ungroup() %>%
mutate(percent = value/total) %>%
select(year, race = race_extract, value, total, percent)
write.csv(demo_data_all, "C:/Users/Colton/Desktop/WOUApp/WOUapp/2010-2019 Demographics.csv")
write.csv(demo, "C:/Users/Colton/Desktop/WOUApp/WOUapp/2010-2019 Demographics.csv")
library(shiny)
library(tidyverse)
# Define UI for application that draws graphs
setwd("C:/Users/Colton/Desktop/WOUApp/WOUapp")
enrollment = read.csv("2010-2019 Enrollment.csv")
demographics = read.csv("2010-2019 Demographics.csv")
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year"),)
View(data_enrollmentgraph)
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
mutate(total = value[race == "Grand"])
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
mutate(total = .$[race == "Grand", value])
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
group_by(year) %>%
mutate(total = value[race == "Grand"])
View(enrollment)
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
group_by(year) %>%
mutate(total = value[race == "Grand"]) %>%
filter(race != "Grand")
demographics = read.csv("2010-2019 Demographics.csv")
library(tidyverse)
library(rsconnect)
library(openxlsx)
#install.packages("devtools")
#devtools::install_github('UrbanInstitute/education-data-package-r')
enrollment_files = list.files("C:/Users/Colton/Desktop/WOUApp/Enrollment", pattern = "*\\.zip", full.names = TRUE)
files = lapply(enrollment_files, unzip, exdir = "C:/Users/Colton/Desktop/WOUApp/Enrollment/unzipped")
csvfiles = bind_rows(lapply(list.files("C:/Users/Colton/Desktop/WOUApp/Enrollment/unzipped", full.names = TRUE, pattern = "*csv"), read.csv))
#names(csvfiles) =  gsub("^.*?\\.", "", names(csvfiles))
enrollment_clean = csvfiles %>%
select(-IDX_EF, -contains("Level"), -year) %>%
pivot_longer(!c(unitid:institution.name), names_to = "race", values_to = "value") %>%
mutate(year = str_extract(race, "[0-9]{4}")) %>%
filter(!is.na(value)) %>%
mutate(race = gsub("^.*?\\.", "", race)) %>%
mutate(race = gsub("\\.total", "", race)) %>%
mutate(race = gsub("\\.", " ", race)) %>%
filter(!grepl("men", race)) %>%
filter(year != 2009) %>%
group_by(year) %>%
mutate(total = value[race == "Grand"]) %>%
filter(race != "Grand")
mutate(percent = value/total)
write.csv(enrollment_clean, "C:/Users/Colton/Desktop/WOUApp/WOUapp/2010-2019 Enrollment.csv")
enrollment_clean = csvfiles %>%
select(-IDX_EF, -contains("Level"), -year) %>%
pivot_longer(!c(unitid:institution.name), names_to = "race", values_to = "value") %>%
mutate(year = str_extract(race, "[0-9]{4}")) %>%
filter(!is.na(value)) %>%
mutate(race = gsub("^.*?\\.", "", race)) %>%
mutate(race = gsub("\\.total", "", race)) %>%
mutate(race = gsub("\\.", " ", race)) %>%
filter(!grepl("men", race)) %>%
filter(year != 2009) %>%
group_by(year) %>%
mutate(total = value[race == "Grand"]) %>%
filter(race != "Grand") %>%
mutate(percent = value/total)
write.csv(enrollment_clean, "C:/Users/Colton/Desktop/WOUApp/WOUapp/2010-2019 Enrollment.csv")
enrollment = read.csv("2010-2019 Enrollment.csv")
demographics = read.csv("2010-2019 Demographics.csv")
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year"),)
View(data_enrollmentgraph)
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment|demographics"))
View(data_enrollmentgraph)
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment | demographics"))
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment"), ends_with("demographics"))
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment"), ends_with("demographics"), -starts_with("X"))
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment"), ends_with("demographics"), -starts_with("X")) %>%
pivot_longer(c(contains("value"), contains("total"), contains("percent")), names_sep = "\\.")
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment"), ends_with("demographics"), -starts_with("X")) %>%
pivot_longer(c(contains("value"), contains("total"), contains("percent")), names_sep = "\\.", names_to = c("type", "type2"))
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment"), ends_with("demographics"), -starts_with("X")) %>%
pivot_longer(c(contains("value"), contains("total"), contains("percent")),
names_sep = "\\.",
names_to = c("valuetype", "source"))
runApp()
runApp()
runApp()
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment"), ends_with("demographics"), -starts_with("X")) %>%
pivot_longer(c(contains("value"), contains("total"), contains("percent")),
names_sep = "\\.",
names_to = c("valuetype", "source"))
data_enrollmentgraph %>%
ggplot(filter(., valuetype == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity"
data_enrollmentgraph %>%
ggplot(filter(., valuetype == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(filter(., valuetype == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
runApp()
data_enrollmentgraph %>%
ggplot(. %>% filter(valuetype == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(. %>% filter(valuetype == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
View(data_enrollmentgraph)
data_enrollmentgraph %>%
ggplot(. %, aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(., aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(filter(., value == "percent")), aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(filter(., value == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(filter(., value == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(data= filter(., value == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(data= filter(., value == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
rlang::last_error()
data_enrollmentgraph %>%
ggplot(., aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(., aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(. %>% filter(., valuetype == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(. %>% filter(valuetype == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(. %>% filter(.$valuetype == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
data_enrollmentgraph %>%
ggplot(filter(., valuetype == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
plot_reactive = reactive({
data_enrollmentgraph %>%
filter(valuetype == "percent") %>%
ggplot(. , aes(x=year, y= value)) + geom_bar(stat="identity")})
runApp()
runApp()
plot_reactive = reactive({
data_enrollmentgraph %>%
filter(valuetype == "percent") %>%
ggplot(. , aes(x=year, y= value, color = race)) + geom_bar(stat="identity")})
runApp()
plot_reactive = reactive({
data_enrollmentgraph %>%
filter(valuetype == "percent") %>%
ggplot(. , aes(x=year, y= value, fill = race)) + geom_bar(stat="identity")})
runApp()
plot_reactive = reactive({
data_enrollmentgraph %>%
filter(valuetype == "percent") %>%
ggplot(. , aes(x=year, y= as.numeric(value), fill = race)) + geom_bar(stat="identity")})
runApp()
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
filter(race != "Nonresident Alient")
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
filter(race != "Nonresident Alient")
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
filter(race != "Nonresident Alien")
demographics = read.csv("2010-2019 Demographics.csv")
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment"), ends_with("demographics"), -starts_with("X")) %>%
pivot_longer(c(contains("value"), contains("total"), contains("percent")),
names_sep = "\\.",
names_to = c("valuetype", "source"))
runApp()
View(demographics)
View(enrollment)
View(demographics)
View(enrollment)
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
filter(race != "Nonresident Alien")
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
filter(race != "Nonresident alien")
demographics = read.csv("2010-2019 Demographics.csv")
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment"), ends_with("demographics"), -starts_with("X")) %>%
pivot_longer(c(contains("value"), contains("total"), contains("percent")),
names_sep = "\\.",
names_to = c("valuetype", "source"))
runApp()
View(data_enrollmentgraph)
View(data_enrollmentgraph)
library(tidyverse)
library(janitor)
# Download ACS data for race from link below:
# https://data.census.gov/cedsci/table?q=race%2Fethnicity%20oregon&tid=ACSDT1Y2018.B02001
# https://data.census.gov/cedsci/table?q=race&tid=ACSDP1Y2019.DP05
setwd("C:/Users/Colton/Desktop/WOUApp")
demo_csvs = data.frame(files = list.files("./Demographics/productDownload_2021-06-01T143832", full.names =  TRUE)) %>%
mutate(data = grepl("data_with_overlays", files)) %>%
filter(data == TRUE)
demo = map_dfr(unique(demo_csvs$files), ~read.csv(.x, skip=1) %>% mutate_all(as.character) %>%
mutate(year = str_extract(.x, "([0-9]{4}(?=\\.{1}))"))) %>%
select(year, ends_with("any.race."), contains("NOT.HISPANIC"), -contains("Margin"), -contains("Percent")) %>%
clean_names(.) %>%
select(-ends_with("hispanic_or_latino")) %>%
pivot_longer(!year, names_to = "race", values_to = "value") %>%
mutate(race_extract = ifelse(grepl("hispanic_or_latino_of_any_race", race), "Hispanic",
ifelse(grepl("white", race), "White",
ifelse(grepl("black", race), "Black or African American",
ifelse(grepl("american_indian", race),  "American Indian or Alaska Native",
ifelse(grepl("native_hawaiian", race),  "Native Hawaiian or Other Pacific Islander",
ifelse(grepl("two_or", race), "Two or more races",
ifelse(grepl("asian", race), "Asian",
ifelse(grepl("some", race), "Race ethnicity unknown",
race))))))))) %>%
filter(!grepl("two_races", race)) %>%
group_by(year, race_extract) %>%
summarize(value = sum(as.numeric(value), na.rm = TRUE)) %>%
group_by(year) %>%
mutate(total = sum(value)) %>%
ungroup() %>%
mutate(percent = value/total) %>%
select(year, race = race_extract, value, total, percent)
write.csv(demo, "C:/Users/Colton/Desktop/WOUApp/WOUapp/2010-2019 Demographics.csv")
##### Not Used
# demo_data = data.frame(File = demo_csvs$files) %>%
#  extract(File, "year", "([0-9]{4}(?=\\.{1}))", remove = FALSE) %>%
#  map_dfr(~)
#  mutate(Data = lapply(File, read_csv, skip = 1)) %>%
#  unnest(Data) %>%
#  clean_names(.) %>%
#  as.data.frame(.) %>%
#  select(year, starts_with("estimate"))
# demo_data_2019 = demo_data %>%
#   filter(year == 2019) %>%
#   select(year, contains("_2")) %>%
#   rename_all(~(stringr::str_replace_all(., '_2', '')))
#
# demo_data_all = demo_data %>%
#   filter(year != 2019) %>%
#   select(year, !contains("_2")) %>%
#   bind_rows(., demo_data_2019) %>%
#   pivot_longer(contains("estimate")) %>%
#   rename(race = "name") %>%
#   mutate(race = recode(race,
#                        "estimate_total" = "Grand",
#                        "estimate_total_white_alone" = "White",
#                        "estimate_total_black_or_african_american_alone" = "Black or African American",
#                        "estimate_total_american_indian_and_alaska_native_alone" = "American Indian or Alaska Native",
#                        "estimate_total_asian_alone" = "Asian",
#                        "estimate_total_native_hawaiian_and_other_pacific_islander_alone" = "Native Hawaiian or Other Pacific Islander",
#                        "estimate_total_some_other_race_alone" = "Race ethnicity unknown",
#                        "estimate_total_two_or_more_races" =  "Two or more races")) %>%
#   filter(!race %in% c("estimate_total_two_or_more_races_two_races_including_some_other_race",
#                       "estimate_total_two_or_more_races_two_races_excluding_some_other_race_and_three_or_more_races")) %>%
#   group_by(year) %>%
#   mutate(percent = value/value[race == "Grand"])
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
filter(race != "Nonresident alien")
demographics = read.csv("2010-2019 Demographics.csv")
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment"), ends_with("demographics"), -starts_with("X")) %>%
pivot_longer(c(contains("value"), contains("total"), contains("percent")),
names_sep = "\\.",
names_to = c("valuetype", "source"))
runApp('WOUapp')
plot_reactive = reactive({
data_enrollmentgraph %>%
filter(valuetype == "percent") %>%
ggplot(. , aes(x=source, y= value, fill = race)) + facet_grid(.~year) + geom_bar(stat="identity", position = "dodge")})
runApp('WOUapp')
runApp('WOUapp')
runApp('WOUapp')
runApp('WOUapp')
ui <- fluidPage(
# Application title
titlePanel("Western Oregon University - Diversity"),
# Sidebar with a slider input for number of bins
sidebarLayout(
sidebarPanel(
selectInput("Year",
"Year:",
choices = seq(2010:2019, 1))
),
# Show a plot of the generated distribution
mainPanel(
plotOutput("plot")
)
)
)
runApp('WOUapp')
runApp('WOUapp')
runApp('WOUapp')
seq(2010:2019)
seq(2010, 2019)
runApp('WOUapp')
runApp('WOUapp')
runApp('WOUapp')
plot_reactive = reactive({
data_enrollmentgraph %>%
#filter(year == input$Year) %>%
filter(valuetype == "percent") %>%
ggplot(. , aes(x=year, y= value, color = race, group=source)) + geom_smooth()})
runApp('WOUapp')
runApp('WOUapp')
plot_reactive = reactive({
data_enrollmentgraph %>%
filter(year == input$Year) %>%
filter(valuetype == "percent") %>%
ggplot(. , aes(x=value, y= race, color = race, group = source)) + geom_point(aes(color = source))})
runApp('WOUapp')
plot_reactive = reactive({
data_enrollmentgraph %>%
filter(year == input$Year) %>%
filter(valuetype == "percent") %>%
ggplot(. , aes(x=value, y= race, group = source)) +
geom_point(aes(color = source)) +
scale_color_manual(values = c("blue", "black"))})
runApp('WOUapp')
plot_reactive = reactive({
data_enrollmentgraph %>%
filter(year == input$Year) %>%
filter(valuetype == "percent") %>%
ggplot(. , aes(x=value, y= race, group = source)) +
geom_point(aes(color = source)) +
scale_color_manual(values = c("blue", "black")) +
xlab("percent") +
theme_minimal() +
theme(axis.line.x = element_line())})
runApp('WOUapp')
runApp('WOUapp')
minimaltheme =
theme(axis.line.x = element_line(),
axis.line.y = element_line(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
runApp('WOUapp')
runApp('WOUapp')
runApp('WOUapp')
runApp('WOUapp')
runApp('WOUapp')
runApp('WOUapp')
runApp('WOUapp')
runApp('WOUapp')
plot_reactive = reactive({
data_enrollmentgraph %>%
filter(year == input$Year) %>%
filter(valuetype == "percent") %>%
mutate(percent = as.numeric(value)*100) %>%
ggplot(., aes(x=percent, y= race, group = source)) +
geom_line(aes(group = race)) +
geom_point(aes(color = source)) +
scale_color_manual(values = c("blue", "black")) +
scale_x_continuous(breaks = seq(0, 100, 10), limits = c(0,100)) +
theme_minimal() +
minimaltheme})
library(shiny)
library(tidyverse)
minimaltheme =
theme(axis.line.x = element_line(),
axis.line.y = element_line(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# Define UI for application that draws graphs
setwd("C:/Users/Colton/Desktop/WOUApp/WOUapp")
enrollment = read.csv("2010-2019 Enrollment.csv") %>%
filter(race != "Nonresident alien")
demographics = read.csv("2010-2019 Demographics.csv")
data_enrollmentgraph = enrollment %>%
left_join(demographics, suffix = c(".enrollment", ".demographics"), by = c("race", "year")) %>%
select(year, race, ends_with("enrollment"), ends_with("demographics"), -starts_with("X")) %>%
pivot_longer(c(contains("value"), contains("total"), contains("percent")),
names_sep = "\\.",
names_to = c("valuetype", "source"))
ui <- fluidPage(
# Application title
titlePanel("Western Oregon University - Diversity"),
# Sidebar with a slider input for number of bins
sidebarLayout(
sidebarPanel(
selectInput("Year",
"Year:",
choices = seq(2010, 2019))
),
# Show a plot of the generated distribution
mainPanel(tabsetPanel("tabs",
tabPanel("Enrollment",
plotOutput("plot"))
)
)
)
)
# Define server logic required to draw a histogram
server <- function(input, output) {
plot_reactive = reactive({
data_enrollmentgraph %>%
filter(year == input$Year) %>%
filter(valuetype == "percent") %>%
mutate(percent = as.numeric(value)*100) %>%
ggplot(., aes(x=percent, y= race, group = source)) +
geom_line(aes(group = race)) +
geom_point(aes(color = source)) +
scale_color_manual(values = c("blue", "black")) +
scale_x_continuous(breaks = seq(0, 100, 10), limits = c(0,100)) +
theme_minimal() +
minimaltheme})
output$plot = renderPlot(plot)
}
#
# data_enrollmentgraph %>%
#     ggplot(filter(., valuetype == "percent"), aes(x=year, y= value)) + geom_bar(stat="identity")
#
